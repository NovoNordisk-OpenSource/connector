<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to extend connector • connector</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to extend connector">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">connector</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/connector.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Consistent-API.html">Understanding Connector Package Methods</a></li>
    <li><a class="dropdown-item" href="../articles/customize.html">How to extend connector</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/novonordisk-opensource/connector/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How to extend connector</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/novonordisk-opensource/connector/blob/main/vignettes/customize.Rmd" class="external-link"><code>vignettes/customize.Rmd</code></a></small>
      <div class="d-none name"><code>customize.Rmd</code></div>
    </div>

    
    
<p><code>connector</code> is build to be easily extensible. This
vignette will show you how to create your own connector classes, and how
to customize the existing ones, and their methods.</p>
<p>The basic <code>connector</code> class is a simple <a href="https://r6.r-lib.org" class="external-link">R6</a>
object, with no additional functionality. It serves as the foundation
for all other connectors, that should inherit from it in their
<code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6::R6Class()</a></code> definition - either directly or indirectly.
Both <code><a href="../reference/connector_fs.html">connector_fs()</a></code> and <code><a href="../reference/connector_dbi.html">connector_dbi()</a></code>
inherit from <code>connector</code> in this way.</p>
<div class="section level2">
<h2 id="creating-a-new-connector">Creating a new connector<a class="anchor" aria-label="anchor" href="#creating-a-new-connector"></a>
</h2>
<p>We can create a new connector by creating a new R6 class that
inherits from <code>connector</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">connector_myclass</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  <span class="st">"connector_myclass"</span>,</span>
<span>  inherit <span class="op">=</span> <span class="va">connector</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">connector_myclass</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;connector_myclass&gt;</span></span></span>
<span><span class="co">#&gt; Inherits from: <span style="color: #0000BB;">&lt;connector&gt;</span></span></span></code></pre></div>
<p>This is the simplest type of inheritance, and you should note that
the <code>connector</code> parent class has no methods capable of
e.g. reading (<code><a href="../reference/read_cnt.html">read_cnt()</a></code>) or writing
(<code><a href="../reference/write_cnt.html">write_cnt()</a></code>) data. It only has default methods that throws
meaningful errors if you have not defined the method
(e.g. <code>write_cnt.my_class()</code>) for your new connector
class.</p>
<p>In most cases you want to inherit from either
<code><a href="../reference/connector_fs.html">connector_fs()</a></code> or <code><a href="../reference/connector_dbi.html">connector_dbi()</a></code> depending on
if your new connector is used to access files or databases
respectively.</p>
<p>Below we create a new <code>connector_project</code> class that
inherits and acts exactly as the <code><a href="../reference/connector_fs.html">connector_fs()</a></code>, but
instead of the user having to provide the <code>path</code> to the
folder as an argument, they provide the <code>project</code> name, and
the <code>path</code> is constructed from that.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">connector_project</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span></span>
<span>  <span class="st">"connector_project"</span>,</span>
<span>  inherit <span class="op">=</span> <span class="va">connector_fs</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">project</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">.project</span> <span class="op">&lt;-</span> <span class="va">project</span></span>
<span>      <span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"my_root_path"</span>, <span class="va">project</span><span class="op">)</span></span>
<span>      <span class="va">super</span><span class="op">$</span><span class="fu">initialize</span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span>,</span>
<span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    .project <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span>,</span>
<span>  active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    project <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">.project</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This way of extending connector could e.g. be relevant inside an
organisation where all projects are stored in a common folder
structure.</p>
<p>When we not initialize a <code>connector_project</code> you can see
that it still has all the methods from <code><a href="../reference/connector_fs.html">connector_fs()</a></code>, and
that the path has been assigned correctly based on the
<code>project</code> argument:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_project</span> <span class="op">&lt;-</span> <span class="va">connector_project</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>project <span class="op">=</span> <span class="st">"my_project"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_project</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;connector_project&gt;</span></span></span>
<span><span class="co">#&gt; Inherits from: <span style="color: #0000BB;">&lt;connector_fs/connector&gt;</span></span></span>
<span><span class="co">#&gt; Registered methods:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `create_directory_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `download_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `list_content_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `read_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `remove_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `remove_directory_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `tbl_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `upload_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `write_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> path: my_root_path/my_project</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> project: my_project</span></span></code></pre></div>
<p>We can now use this <code>connector</code> to read and write data,
just as we would with <code><a href="../reference/connector_fs.html">connector_fs()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First list current content:</span></span>
<span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/list_content_cnt.html">list_content_cnt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; character(0)</span></span>
<span></span>
<span><span class="co"># Write some content:</span></span>
<span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/write_cnt.html">write_cnt</a></span><span class="op">(</span><span class="st">"Hello world!"</span>, <span class="st">"my_file.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># List content again:</span></span>
<span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/list_content_cnt.html">list_content_cnt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "my_file.txt"</span></span>
<span></span>
<span><span class="co"># Read the content:</span></span>
<span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/read_cnt.html">read_cnt</a></span><span class="op">(</span><span class="st">"my_file.txt"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hello world!"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-custom-generic-method">Create custom generic method<a class="anchor" aria-label="anchor" href="#create-custom-generic-method"></a>
</h2>
<p>All <code>connector</code>generics such as
<code><a href="../reference/list_content_cnt.html">list_content_cnt()</a></code>, <code><a href="../reference/read_cnt.html">read_cnt()</a></code>, and
<code><a href="../reference/write_cnt.html">write_cnt()</a></code> are S3 generics. This means that you can create
custom methods for your new connector class, and they will be used when
the generic is called, instead of the one associated with the parent
class.</p>
<p>To illustrate this we can take a look at the
<code><a href="../reference/list_content_cnt.html">list_content_cnt()</a></code> generic:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print the generic </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">list_content_cnt</span><span class="op">)</span></span>
<span><span class="co">#&gt; function (connector_object, ...) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     UseMethod("list_content_cnt")</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x55f223077aa8&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:connector&gt;</span></span>
<span></span>
<span><span class="co"># List the registered s3 methods</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span><span class="st">"list_content_cnt"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span>sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; list_content_cnt.connector_dbi</span></span>
<span><span class="co">#&gt; list_content_cnt.connector_fs</span></span>
<span><span class="co">#&gt; list_content_cnt.default</span></span></code></pre></div>
<p>Building further on the example below we can define a custom method
for <code><a href="../reference/list_content_cnt.html">list_content_cnt()</a></code> for the
<code>connector_project</code> class, to be used instead of
<code><a href="../reference/list_content_cnt.html">list_content_cnt.connector_fs()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_content_cnt.connector_project</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">connector_object</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert</a></span><span class="op">(</span><span class="st">"Listing content of {connector_object$project}"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">NextMethod</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This is of course a very simple example, that just prints a message
before calling the <code>connector_fs</code> method.</p>
<p>We can now see that this method is available and that is it
associated with the <code>connector_project</code> class:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List methods again</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span><span class="st">"list_content_cnt"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span>sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; list_content_cnt.connector_dbi</span></span>
<span><span class="co">#&gt; list_content_cnt.connector_fs</span></span>
<span><span class="co">#&gt; list_content_cnt.connector_project</span></span>
<span><span class="co">#&gt; list_content_cnt.default</span></span>
<span></span>
<span><span class="co"># Print my_project connector to see associated methods</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_project</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;connector_project&gt;</span></span></span>
<span><span class="co">#&gt; Inherits from: <span style="color: #0000BB;">&lt;connector_fs/connector&gt;</span></span></span>
<span><span class="co">#&gt; Registered methods:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `list_content_cnt.connector_project()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `create_directory_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `download_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `read_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `remove_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `remove_directory_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `tbl_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `upload_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `write_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> path: my_root_path/my_project</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> project: my_project</span></span></code></pre></div>
<p>And when we use <code><a href="../reference/list_content_cnt.html">list_content_cnt()</a></code> on our
<code>my_project</code> object, we see that the custom method is used
and we get the message:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/list_content_cnt.html">list_content_cnt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Listing content of my_project</span></span>
<span><span class="co">#&gt; [1] "my_file.txt"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use-extra-class-for-simple-customization">Use extra class for simple customization<a class="anchor" aria-label="anchor" href="#use-extra-class-for-simple-customization"></a>
</h2>
<p>If you as above just want to slightly tweak the behavior of an
existing functionality an alternative solution is to use the
<code>extra_class</code> argument when initializing of the
connector.</p>
<p>This argument adds the <code>extra_class</code> as the first class of
the creating the connector, meaning that for any generic dispatch, such
as of <code><a href="../reference/list_content_cnt.html">list_content_cnt()</a></code>, a method for this class will be
used before any of the connector classes.</p>
<p>To redo the two examples above we make a new
<code>connector_fs</code> with the extra class
<code>demo_extra</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_project_extra</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/connector_fs.html">connector_fs</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"my_root_path/my_project"</span>, </span>
<span>  extra_class <span class="op">=</span> <span class="st">"my_extra_class"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_project_extra</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;my_extra_class/connector_fs&gt;</span></span></span>
<span><span class="co">#&gt; Inherits from: <span style="color: #0000BB;">&lt;connector&gt;</span></span></span>
<span><span class="co">#&gt; Registered methods:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `create_directory_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `download_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `list_content_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `read_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `remove_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `remove_directory_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `tbl_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `upload_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `write_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> path: my_root_path/my_project</span></span></code></pre></div>
<p>As you can see here we have all the methods from
<code><a href="../reference/connector_fs.html">connector_fs()</a></code>, but the <code>demo_extra</code> is now the
first class in the class hierarchy.</p>
<p>To create a custom method for <code><a href="../reference/list_content_cnt.html">list_content_cnt()</a></code> for the
<code>demo_extra</code> we do the same as for the
<code>connector_project</code> above:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_content_cnt.my_extra_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">connector_object</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert</a></span><span class="op">(</span><span class="st">"Listing content of {connector_object$path}"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">NextMethod</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The project information is of course not available now, so we just
print the path instead, but otherwise everything is the same:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List methods</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span><span class="st">"list_content_cnt"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] list_content_cnt.connector_dbi*    list_content_cnt.connector_fs*    </span></span>
<span><span class="co">#&gt; [3] list_content_cnt.connector_project list_content_cnt.default*         </span></span>
<span><span class="co">#&gt; [5] list_content_cnt.my_extra_class   </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span>
<span></span>
<span><span class="co"># Print my_project_extra connector to see associated methods</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_project_extra</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;my_extra_class/connector_fs&gt;</span></span></span>
<span><span class="co">#&gt; Inherits from: <span style="color: #0000BB;">&lt;connector&gt;</span></span></span>
<span><span class="co">#&gt; Registered methods:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `list_content_cnt.my_extra_class()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `create_directory_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `download_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `read_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `remove_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `remove_directory_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `tbl_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `upload_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `write_cnt.connector_fs()`</span></span>
<span><span class="co">#&gt; Specifications:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> path: my_root_path/my_project</span></span>
<span></span>
<span><span class="co"># List content to see the new message</span></span>
<span><span class="va">my_project_extra</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/list_content_cnt.html">list_content_cnt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Listing content of my_root_path/my_project</span></span>
<span><span class="co">#&gt; [1] "my_file.txt"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="special-handling-of-files">Special handling of files<a class="anchor" aria-label="anchor" href="#special-handling-of-files"></a>
</h2>
<p>A special property of file storage connectors (inheriting from
<code><a href="../reference/connector_fs.html">connector_fs()</a></code>) is that they are operating on files not on
databases. This means that they can handle multiple file formats, and
also not only file formats for reading and writing rectangular data.</p>
<p>When handling files the user will only use the
<code><a href="../reference/read_cnt.html">read_cnt()</a></code> and <code><a href="../reference/write_cnt.html">write_cnt()</a></code> generics, but
behind the scenes the following chain of functions are called:</p>
<ul>
<li>
<code><a href="../reference/read_cnt.html">read_cnt()</a></code> –&gt; <code><a href="../reference/read_file.html">read_file()</a></code> –&gt;
<code><a href="../reference/read_file.html">read_ext()</a></code> –&gt; External read function</li>
<li>
<code><a href="../reference/write_cnt.html">write_cnt()</a></code> –&gt; <code><a href="../reference/write_file.html">write_file()</a></code> –&gt;
<code><a href="../reference/write_file.html">write_ext()</a></code> –&gt; External write function</li>
</ul>
<p>Here <code><a href="../reference/read_cnt.html">read_cnt()</a></code> dispatches based on the class of the
<code>connector</code> object. For the file storage connectors
(inheriting from <code><a href="../reference/connector_fs.html">connector_fs()</a></code>) the
<code><a href="../reference/read_file.html">read_file()</a></code> method is then called on the path of the
file.</p>
<p><code><a href="../reference/read_file.html">read_file()</a></code> here is only a helper function, that then
calls <code><a href="../reference/read_file.html">read_ext()</a></code> which is a generic that dispatches based
on file extension of the file, and uses general functions from other
packages to read the file. As an example any file with the extension
<code>.csv</code> will be read using <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code>.</p>
<p>The same logic applies to <code><a href="../reference/write_cnt.html">write_cnt()</a></code>.</p>
<div class="section level3">
<h3 id="add-new-file-format">Add new file format<a class="anchor" aria-label="anchor" href="#add-new-file-format"></a>
</h3>
<p>The currently supported file types can be seen in reference of the
<code><a href="../reference/read_cnt.html">read_cnt()</a></code> and <code><a href="../reference/write_cnt.html">write_cnt()</a></code> functions
respectively.</p>
<p>But let us imagine we want to support a new imaginary file format
<code>myformat</code>. In order to this all we need to do is to create
the appropriate <code><a href="../reference/read_file.html">read_ext()</a></code> and <code><a href="../reference/write_file.html">write_ext()</a></code>
methods:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">read_ext.myformat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">path</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert</a></span><span class="op">(</span><span class="st">"Reading myformat file"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span>con <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">write_ext.myformat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span>, <span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html" class="external-link">cli_alert</a></span><span class="op">(</span><span class="st">"Writing myformat file"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">x</span>, con <span class="op">=</span> <span class="va">file</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>And we can now use them to write and read our new file format with
out existing <code>my_project</code> connector:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List already existing content:</span></span>
<span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/list_content_cnt.html">list_content_cnt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Listing content of my_project</span></span>
<span><span class="co">#&gt; [1] "my_file.txt"</span></span>
<span></span>
<span><span class="co"># Write some content in myformat:</span></span>
<span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/write_cnt.html">write_cnt</a></span><span class="op">(</span><span class="st">"Hello new format!"</span>, <span class="st">"new_file.myformat"</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Writing myformat file</span></span>
<span></span>
<span><span class="co"># List content again:</span></span>
<span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/list_content_cnt.html">list_content_cnt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Listing content of my_project</span></span>
<span><span class="co">#&gt; [1] "my_file.txt"       "new_file.myformat"</span></span>
<span></span>
<span><span class="co"># Read the content:</span></span>
<span><span class="va">my_project</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/read_cnt.html">read_cnt</a></span><span class="op">(</span><span class="st">"new_file.myformat"</span><span class="op">)</span></span>
<span><span class="co">#&gt; → Reading myformat file</span></span>
<span><span class="co">#&gt; [1] "Hello new format!"</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cervan Girard, Aksel Thomsen, Vladimir Obucina.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
