---
format: html
editor: source
---


```{r}
library(yaml)
library(config)
library(purrr)
library(stringr)
pkgload::load_all()
```


Read and understand the yaml file

```{r}
yaml_file <- system.file("config", "default_config.yml", package = "connector")
yaml_content <- yaml::read_yaml(yaml_file, eval.expr=TRUE)

class(yaml_content)
print(yaml_content)

extract_element <- function(yaml_content, element){
    yaml_content[[element]]
}

extract_metadata <- function(yaml_content){
    extract_element(yaml_content, "metadata")
}


extract_connections <- function(yaml_content){
        extract_element(yaml_content, "connections")
}

extract_datasources <- function(yaml_content){
        extract_element(yaml_content, "datasources")
}

extract_backends <- function(yaml_content){
    extract_element(yaml_content, "backend")
}

extract_datasources(yaml_content)
```

## Prepare connections for datasources


#### First try for connector_fs

```{r}
only_one <- extract_connections(yaml_content)[[1]]

## Extract fct
my_backend <- only_one %>%
    extract_backends()

### Check Params available
params_from_function <- formals(connect_fct) %>%
    names()

#### Create the backend for fs

test <- create_backend_fs(yaml_content, my_backend)


```

#### Second try for connector_db